{"ast":null,"code":"import * as jsPDF from 'jspdf';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/carrito.service\";\nimport * as i2 from \"../services/detalle-factura.service\";\nimport * as i3 from \"../services/auth.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction CarritoComponent_div_1_tr_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 10);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\", 8);\n    i0.ɵɵelement(8, \"img\", 11);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const det_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(det_r3.producto == null ? null : det_r3.producto.nombre);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(det_r3.cantidad);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(det_r3.precio);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", det_r3.producto == null ? null : det_r3.producto.url, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction CarritoComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"div\", 6)(2, \"p\")(3, \"strong\");\n    i0.ɵɵtext(4, \"C\\u00F3digo del Cliente:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\")(7, \"strong\");\n    i0.ɵɵtext(8, \"Nombre del Cliente:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\")(11, \"strong\");\n    i0.ɵɵtext(12, \"DNI del Cliente:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"table\", 7)(15, \"thead\")(16, \"tr\")(17, \"th\");\n    i0.ɵɵtext(18, \"Producto\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"th\");\n    i0.ɵɵtext(20, \"Cantidad\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"th\");\n    i0.ɵɵtext(22, \"Precio\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"th\", 8);\n    i0.ɵɵtext(24, \"Imagen\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(25, \"tbody\");\n    i0.ɵɵtemplate(26, CarritoComponent_div_1_tr_26_Template, 9, 4, \"tr\", 9);\n    i0.ɵɵpipe(27, \"async\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(28, \"p\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const car_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", car_r1.cliente == null ? null : car_r1.cliente.codigo, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", car_r1.cliente == null ? null : car_r1.cliente.nombre, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", car_r1.cliente == null ? null : car_r1.cliente.dni, \"\");\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(27, 4, ctx_r0.detalles));\n  }\n}\nexport let CarritoComponent = /*#__PURE__*/(() => {\n  class CarritoComponent {\n    constructor(carritosService, detallesServices, authService) {\n      this.carritosService = carritosService;\n      this.detallesServices = detallesServices;\n      this.authService = authService;\n      this.personaAutenticada = this.authService.getUsuarioAutenticado().correo;\n      this.codigoAutenticada = this.authService.getUsuarioAutenticado().codigo;\n    } // Inyecta tu servicio aquí\n    ngOnInit() {\n      this.carritos = this.carritosService.getCarrito(this.codigoAutenticada);\n      this.detalles = this.detallesServices.getDetalleCarrito(this.codigoAutenticada);\n    }\n    realizarCompra() {\n      // Asegúrate de que la imagen no se muestra en la impresión\n      document.querySelectorAll('.no-print').forEach(el => {\n        if (el instanceof HTMLElement) {\n          el.style.display = 'none';\n        }\n      });\n      // Encuentra el formulario que deseas imprimir\n      const formElement = document.getElementById('frm');\n      if (formElement) {\n        // Clona el formulario que deseas imprimir\n        const formToPrint = formElement.cloneNode(true);\n        // Asegúrate de que el clon es un elemento HTML para poder manipularlo\n        if (formToPrint instanceof HTMLElement) {\n          // Elimina todos los elementos con la clase 'no-print' del clon\n          formToPrint.querySelectorAll('.no-print').forEach(element => {\n            element.remove();\n          });\n          // Crea una nueva instancia de jsPDF\n          const doc = new jsPDF();\n          // Renderiza el clon en el PDF, no el formulario original\n          doc.fromHTML(formToPrint, 20, 5, {\n            'width': 170 // Asegúrate de establecer un ancho si es necesario\n          }, () => {\n            // Guarda el PDF\n            doc.save('Factura.pdf');\n          });\n          // Vuelve a mostrar los elementos que habían sido ocultados, si es necesario\n          document.querySelectorAll('.no-print').forEach(el => {\n            if (el instanceof HTMLElement) {\n              el.style.display = '';\n            }\n          });\n        }\n      } else {\n        console.error('El formulario con id \"frm\" no se encuentra en el DOM.');\n      }\n      this.detallesServices.crearFacturas(this.codigoAutenticada).subscribe(response => {\n        if (typeof response === 'string') {\n          // La respuesta es un mensaje de éxito como texto\n          console.log(response);\n          // Puedes mostrar este mensaje en tu interfaz de usuario si es necesario\n        } else {\n          // La respuesta es un objeto JSON válido, puedes manejarlo según corresponda\n          console.log(response);\n        }\n      }, error => {\n        console.error(error);\n        // Manejar el error según tus necesidades\n      });\n    }\n\n    imprimir() {}\n    static #_ = this.ɵfac = function CarritoComponent_Factory(t) {\n      return new (t || CarritoComponent)(i0.ɵɵdirectiveInject(i1.CarritoService), i0.ɵɵdirectiveInject(i2.DetalleFacturaService), i0.ɵɵdirectiveInject(i3.AuthService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: CarritoComponent,\n      selectors: [[\"app-carrito\"]],\n      decls: 12,\n      vars: 3,\n      consts: [[\"id\", \"frm\"], [\"class\", \"customer-details\", 4, \"ngFor\", \"ngForOf\"], [1, \"btn-realizar-compra\", 3, \"click\"], [1, \"container\"], [\"href\", \"#\"], [1, \"customer-details\"], [1, \"customer-info\"], [1, \"order-details\"], [1, \"no-print\"], [4, \"ngFor\", \"ngForOf\"], [1, \"product-name\"], [\"alt\", \"Imagen del producto\", 2, \"max-width\", \"100px\", \"max-height\", \"100px\", 3, \"src\"]],\n      template: function CarritoComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"form\", 0);\n          i0.ɵɵtemplate(1, CarritoComponent_div_1_Template, 29, 6, \"div\", 1);\n          i0.ɵɵpipe(2, \"async\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"button\", 2);\n          i0.ɵɵlistener(\"click\", function CarritoComponent_Template_button_click_3_listener() {\n            return ctx.realizarCompra();\n          });\n          i0.ɵɵtext(4, \"Realizar Compra\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"footer\", 3)(6, \"small\")(7, \"a\", 4);\n          i0.ɵɵtext(8, \"Sobre la tienda\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(9, \" \\u2022 \");\n          i0.ɵɵelementStart(10, \"a\", 4);\n          i0.ɵɵtext(11, \"T\\u00E9rminos y Condiciones\");\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(2, 1, ctx.carritos));\n        }\n      },\n      dependencies: [i4.NgForOf, i5.ɵNgNoValidate, i5.NgControlStatusGroup, i4.AsyncPipe],\n      styles: [\".customer-details[_ngcontent-%COMP%]{margin:20px;padding:20px;border:1px solid #ccc;background-color:#f5f5f5;box-shadow:0 0 10px #0000001a;border-radius:5px}.customer-info[_ngcontent-%COMP%]{background-color:#f2f2f2;color:#333;padding:10px;margin-bottom:10px;border-radius:5px;font-size:16px}.order-details[_ngcontent-%COMP%]{font-size:16px;width:100%}.order-details[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f2f2f2;color:#333}.order-details[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .order-details[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ccc;padding:8px;text-align:left}.product-name[_ngcontent-%COMP%]{width:auto;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.btn-realizar-compra[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-size:16px;display:flex;align-items:center}.icon-shopping-cart[_ngcontent-%COMP%]{margin-left:10px;font-size:24px}@media print{.no-print[_ngcontent-%COMP%]{display:none}}\"]\n    });\n  }\n  return CarritoComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}